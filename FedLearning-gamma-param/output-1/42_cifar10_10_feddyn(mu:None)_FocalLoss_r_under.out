None
fed_config: {'method': 'feddyn', 'init_round': None, 'num_rounds': 300, 'num_clients': 100, 'fraction': 0.1, 'alpha': 10.0}
data_config: {'name': 'cifar10', 'num_classes': 10, 'alpha': 10.0, 'sampling_type': 'r_under'}
tm_config: {'lr': 0.01, 'momentum': 0.9, 'name': 'cifar10_cnn', 'criterion': 'FocalLoss', 'optimizer': 'SGD', 'local_ep': 1, 'local_bs': 10, 'mu': None}
system_config: {'is_mp': False, 'device': 'cuda', 'seed': 42, 'log_dir': 'log/cifar10/42_cifar10_10.0_feddyn(None)_FocalLoss_r_under', 'time_config': '2022-12-12_05:05:57', 'device_id': '3'}
Files already downloaded and verified
Files already downloaded and verified
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under
sampling_type: r_under

[WELCOME] Unfolding configurations...!
cifar10_cnn(
  (activation): ReLU(inplace=True)
  (conv1): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1), padding=(1, 1), bias=False)
  (maxpool1): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=1, dilation=1, ceil_mode=False)
  (conv2): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1), padding=(1, 1), bias=False)
  (maxpool2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=1, dilation=1, ceil_mode=False)
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (fc1): Linear(in_features=4096, out_features=512, bias=False)
  (fc2): Linear(in_features=512, out_features=10, bias=False)
)
[Round: 0000] ...successfully initialized model (# parameters: 2155872)!
0it [00:00, ?it/s]                  [Round: 0000] ...successfully created all 100 clients!
0it [00:00, ?it/s]                  [Round: 0000] ...successfully finished setup of all 100 clients!
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:10,  9.10it/s]  4%|▍         | 4/100 [00:00<00:04, 19.82it/s]  7%|▋         | 7/100 [00:00<00:04, 22.10it/s] 10%|█         | 10/100 [00:00<00:03, 23.27it/s] 13%|█▎        | 13/100 [00:00<00:03, 23.65it/s] 16%|█▌        | 16/100 [00:00<00:03, 25.20it/s] 21%|██        | 21/100 [00:00<00:02, 31.67it/s] 27%|██▋       | 27/100 [00:00<00:01, 38.61it/s] 33%|███▎      | 33/100 [00:01<00:01, 44.30it/s] 38%|███▊      | 38/100 [00:01<00:01, 41.78it/s] 43%|████▎     | 43/100 [00:01<00:01, 35.07it/s] 47%|████▋     | 47/100 [00:01<00:01, 30.27it/s] 53%|█████▎    | 53/100 [00:01<00:01, 36.27it/s] 58%|█████▊    | 58/100 [00:01<00:01, 35.39it/s] 64%|██████▍   | 64/100 [00:01<00:00, 40.53it/s] 71%|███████   | 71/100 [00:02<00:00, 46.50it/s] 77%|███████▋  | 77/100 [00:02<00:00, 49.27it/s] 83%|████████▎ | 83/100 [00:02<00:00, 42.63it/s] 90%|█████████ | 90/100 [00:02<00:00, 48.83it/s] 96%|█████████▌| 96/100 [00:02<00:00, 49.77it/s]                                                [Round: 0000] ...successfully transmitted models to all 100 clients!
[Round: 0001] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 60%|██████    | 6/10 [00:00<00:00, 59.40it/s]                                              [Round: 0001] ...successfully transmitted models to 10 selected clients!
[Round: 0001] Start updating selected 10 clients...!
  0%|          | 0/10 [00:00<?, ?it/s]                                      run undersampling on client #0
sampling_type: r_under_client
Traceback (most recent call last):
  File "main.py", line 108, in <module>
    central_server.fit()
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/server.py", line 314, in fit
    self.train_federated_model()
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/server.py", line 251, in train_federated_model
    selected_total_size = self.update_selected_clients(sampled_client_indices)
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/server.py", line 172, in update_selected_clients
    self.clients[idx].client_update(self._round)
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/feddyn_client.py", line 157, in client_update
    self.task_model_update()
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/feddyn_client.py", line 106, in task_model_update
    self.update_undersampling()
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/feddyn_client.py", line 78, in update_undersampling
    newly_undersampling = ClientDataset(
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/sampling.py", line 133, in __init__
    self.data, self.targets = self.sampling()
  File "/home/ijeong/workspace/prml_federeated_learning/FedLearning-gamma-param/src/sampling.py", line 177, in sampling
    from imblearn.under_sampling import RandomUnderSampler
ModuleNotFoundError: No module named 'imblearn'
